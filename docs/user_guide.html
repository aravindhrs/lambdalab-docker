

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Codatlas New User Guide &mdash; Lambdalab-docs 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Lambdalab-docs 1.0.0 documentation" href="index.html"/>
        <link rel="prev" title="Insight.io Private Cloud Version Quick Install" href="on_prem_install.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index_enterprise.html" class="icon icon-home"> Lambdalab-docs
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="on_prem_install.html">Insight.io Private Cloud Version Quick Install</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Codatlas New User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#config-to-use-ldap">Config to use LDAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-an-account">Create an Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-repository">Add Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-gitlab-plugin">Use Gitlab Plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#install-and-config-native-gitlab-plugin">Install and Config Native Gitlab Plugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#change-settings-xml-for-maven-project">Change settings.xml for Maven project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customize-repository-build">Customize Repository Build</a></li>
<li class="toctree-l2"><a class="reference internal" href="#obtain-build-log-from-jenkins">Obtain Build Log from Jenkins</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-api-access-token">Use Api Access Token</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#token-creation">Token Creation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creation-after-authentication">Creation after Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-before-authentication">Creation before Authentication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#token-usage">Token Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#token-deletion">Token Deletion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list-all-tokens">List All Tokens</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#import-projects">Import Projects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-project-via-git-urls">Import Project via Git Urls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-manual-update">Configure Manual Update</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#system-level-manual-update">System Level Manual Update</a></li>
<li class="toctree-l4"><a class="reference internal" href="#project-level-manual-update">Project Level Manual Update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#trigger-manual-update">Trigger Manual Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="#switch-a-repo-from-public-to-private">Switch a Repo from Public to Private</a></li>
<li class="toctree-l3"><a class="reference internal" href="#push-user-access-throught-api">Push User Access throught API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index_enterprise.html">Lambdalab-docs</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index_enterprise.html">Docs</a> &raquo;</li>
        
      <li>Codatlas New User Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/user_guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="codatlas-new-user-guide">
<h1>Codatlas New User Guide<a class="headerlink" href="#codatlas-new-user-guide" title="Permalink to this headline">¶</a></h1>
<p>This chapter is intended to go through the basics of how to use Insight.io. For the rest of the chapter, <code class="docutils literal"><span class="pre">$HostName</span></code> refers to the public DNS address that has Insight.io installed. For example if you using AWS <code class="docutils literal"><span class="pre">$HostName</span></code> could be <code class="docutils literal"><span class="pre">http://ec2-52-35-135-191.us-west-2.compute.amazonaws.com</span></code></p>
<div class="section" id="config-to-use-ldap">
<h2>Config to use LDAP<a class="headerlink" href="#config-to-use-ldap" title="Permalink to this headline">¶</a></h2>
<p>Insight.io can use LDAP for authentication with some simple configuration. You can configure these options in <code class="docutils literal"><span class="pre">lambdalan-enterprise.conf</span></code> and uncomment the ldap section, as shown below:</p>
<img alt="_images/ldap_config.png" class="align-center" src="_images/ldap_config.png" />
<p>Alternatively, you can also setup the LDAP config in <code class="docutils literal"><span class="pre">$HOSTNAME/projects/admin</span></code>, the config set in the webpage will be stored in the databse and overwrite the one in config file.</p>
<p>Note that as long as <code class="docutils literal"><span class="pre">Provider</span> <span class="pre">URL</span></code> property is non-empty, LDAP log in will be enabled and normal username/password login will be disabled.</p>
<p>If your company&#8217;s LDAP is using a self-signed CA, Insight.io will need to add the certificate into it&#8217;s JVM truststore to enable SSL authentication. To do this, simply put the certificate the following folder:</p>
<p><code class="docutils literal"><span class="pre">lambdalab-docker/certs</span></code></p>
<p>This folder will be mounted into Insight.io container and all the certificate within will be added into Insight.io trustore.</p>
</div>
<div class="section" id="create-an-account">
<h2>Create an Account<a class="headerlink" href="#create-an-account" title="Permalink to this headline">¶</a></h2>
<p>You can create an account at</p>
<p><code class="docutils literal"><span class="pre">http://$HostName/signup</span></code></p>
<p>The account can either be created with an email and a password, or directly by login with Github account if the admin has setup Github integration.</p>
<p>Note that the first account that is created will be granted admin access.</p>
</div>
<div class="section" id="add-repository">
<h2>Add Repository<a class="headerlink" href="#add-repository" title="Permalink to this headline">¶</a></h2>
<p>If you are using Github integration with Insight.io and logged in with your Github account, simply go to</p>
<p><code class="docutils literal"><span class="pre">http://$HostName/myprojects</span></code></p>
<p>Click on <code class="docutils literal"><span class="pre">Authorize</span> <span class="pre">Github</span> <span class="pre">Public/Private</span> <span class="pre">Repo</span> <span class="pre">Access</span></code> buttons to grant Insight.io access to the public/private repos under your Github account respectively, after which all your repos should be listed under Repositories. Click on the <code class="docutils literal"><span class="pre">Import</span> <span class="pre">this</span> <span class="pre">repo</span></code> switch for the ones you want to import. This will kick-off the code analysis process.</p>
<p>If you are not using Github integration, log in with the account with admin access, and go to:</p>
<p><code class="docutils literal"><span class="pre">http://$HostName/admin/projects</span></code></p>
<p>Put the git clone address (e.g. <a class="reference external" href="https://github.com/apache/hadoop.git">https://github.com/apache/hadoop.git</a>) into <code class="docutils literal"><span class="pre">Enter</span> <span class="pre">url</span> <span class="pre">here</span></code> text box and click on &#8220;Submit&#8221;. You will see the repo showing up in All projects list.</p>
</div>
<div class="section" id="use-gitlab-plugin">
<h2>Use Gitlab Plugin<a class="headerlink" href="#use-gitlab-plugin" title="Permalink to this headline">¶</a></h2>
<div class="section" id="install-and-config-native-gitlab-plugin">
<h3>Install and Config Native Gitlab Plugin<a class="headerlink" href="#install-and-config-native-gitlab-plugin" title="Permalink to this headline">¶</a></h3>
<p>If you are self-hosting Gitlab, Codatlas also provides a native Gitlab Plugin that could add cross-reference to Gitlab page without the requirement of every user to install a Chrome Plugin. The installation requires
the administrator having direct access to Gitlab deployment.</p>
<p>First, download the plugin by</p>
<p><code class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/lambdalab/plugin.git</span></code></p>
<p>The repository only contains two javascript files, put the js files under</p>
<p><code class="docutils literal"><span class="pre">$GITLAB_DIR/public/assets/insightio</span></code></p>
<p>where <code class="docutils literal"><span class="pre">$GITLAB_DIR</span></code> is your gitlab installation folder. For example for an ubnuntu Omnibus release, the folder path could look like:</p>
<p><code class="docutils literal"><span class="pre">/opt/gitlab/embedded/service/gitlab-rails</span></code>.</p>
<p>Then in your <code class="docutils literal"><span class="pre">$GITLAB_DIR/app/views/layouts/_head.html.haml</span></code>, add following line</p>
<p><code class="docutils literal"><span class="pre">=</span> <span class="pre">javascript_include_tag</span> <span class="pre">'/assets/insightio/plugin.js'</span></code></p>
<p>after</p>
<p><code class="docutils literal"><span class="pre">=</span> <span class="pre">javascript_include_tag</span> <span class="pre">&quot;application&quot;</span></code>.</p>
<p>Finally, we need to config the plugin to work correctly with your Gitlab and Codatas installation.
Open <code class="docutils literal"><span class="pre">$GITLAB_DIR/public/assets/insightio/plugin.js</span></code> and make change to the configuration section:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">lambdalabConfig</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">url</span><span class="p">:</span> <span class="s2">&quot;http://localhost:9000&quot;</span><span class="p">,</span>

        <span class="n">externalUrl</span><span class="p">:</span> <span class="s2">&quot;https://insight.io&quot;</span><span class="p">,</span>

        <span class="n">enablePlugin</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">url</span></code>: the URL of your on-prem Codatlas instance</p>
<p><code class="docutils literal"><span class="pre">externalUrl</span></code>: The fall-back server the plugin will be used to resolve a node that is not found within your on-prem instance. For example the definition of <code class="docutils literal"><span class="pre">java.lang.String</span></code> may not be found on your on-prem Codatlas instance but will be resolved on insight.io. Set this to empty if you want to disable this feature</p>
<p><code class="docutils literal"><span class="pre">enablePlugin</span></code>: Whether you want to enable the plugin by default. When set to false, users have to explicitly attach <code class="docutils literal"><span class="pre">enablePlugin=true</span></code> query parameter in the URL to enable the plugin. When set to true, the plugin is always enabled for all users.</p>
<p>You could see a demo deployment <a class="reference external" href="http://gitlab.insight.io/zfy0701/pysonar2/blob/master/src/main/java/org/yinwang/pysonar/Analyzer.java">here</a>.</p>
</div>
</div>
<div class="section" id="change-settings-xml-for-maven-project">
<h2>Change settings.xml for Maven project<a class="headerlink" href="#change-settings-xml-for-maven-project" title="Permalink to this headline">¶</a></h2>
<p>Sometimes you may be using your own Maven Central server to either speed up dependency download or host your own jars in your enterprise network, and usually this custom Maven Central server address is specified in settings.xml file.</p>
<p>In order to make user-specified settings.xml visible to Codatlas&#8217;s docker container, you need to mount the file into the container. To do that, open docker-compose.yml (or cn-docker-compose.yml if you use cn-lambda-compose to start the stack) with a text editor, and add the following line under <code class="docutils literal"><span class="pre">services:tools:volumes</span></code> section:</p>
<p><code class="docutils literal"><span class="pre">$PATH_TO_SETTINGS.xml:/lambda_home/tools/maven/conf/settings.xml</span></code></p>
<p>where <code class="docutils literal"><span class="pre">$PATH_TO_SETTINGS.xml</span></code> is the absolute path to the settings.xml you want Codatlas to use.</p>
<img alt="_images/setting_example.png" class="align-center" src="_images/setting_example.png" />
<p>After the change is applied, refresh docker stack by:</p>
<p><code class="docutils literal"><span class="pre">./lambda-compose</span> <span class="pre">up</span> <span class="pre">-d</span></code></p>
</div>
<div class="section" id="customize-repository-build">
<h2>Customize Repository Build<a class="headerlink" href="#customize-repository-build" title="Permalink to this headline">¶</a></h2>
<p>Codatlas is designed to automatically detect build system used for the repository and run default command such as <code class="docutils literal"><span class="pre">mvn</span> <span class="pre">package</span></code> or <code class="docutils literal"><span class="pre">gradle</span> <span class="pre">build</span></code> to kick off the build steps, which should work well for most of the repositories. However in cases such as when the project need to download some dependencies up-front, or when some custom build steps, Codatlas provided config settings to customize build steps.</p>
<p>To enter the project config page, login with an admin account, go to Admin Console, hover on the project item and click on the config icon, as shown below.</p>
<img alt="_images/project_config.png" class="align-center" src="_images/project_config.png" />
<p>There are 3 sections of the build config, namely Checkout, Dependencies and Build. Checkout section will be triggered after the repository is cloned, this section is designed for tasks such as checkout a sub-repo. Dependencies section will be run before the build steps are run, this section is designed for downloading dependencies that are not covered by the build script, such as C++ dependencies or other library usually installed by using apt-get. Build section is designed for control the build steps to replace common ones such as <code class="docutils literal"><span class="pre">mvn</span> <span class="pre">package</span></code> or <code class="docutils literal"><span class="pre">gradle</span> <span class="pre">build</span></code></p>
</div>
<div class="section" id="obtain-build-log-from-jenkins">
<h2>Obtain Build Log from Jenkins<a class="headerlink" href="#obtain-build-log-from-jenkins" title="Permalink to this headline">¶</a></h2>
<p>Internally Codatlas uses Jenkins to build your project and relies on the build process to perform code analysis. If you see the project does not have any code refernce, chances are there are some issue with the build process. In order to diagnose the issue, you can open a web browser and open Jenkins to obtain the log:</p>
<p><code class="docutils literal"><span class="pre">http://$HostName:8080</span></code></p>
<p>Locate the build job on right hand side from <code class="docutils literal"><span class="pre">Build</span> <span class="pre">History</span></code> list, the name of the job will contain the name of the project. See below image for example.</p>
<img alt="_images/job_detail.png" class="align-center" src="_images/job_detail.png" />
<p>Click the latest number as shown in the graph. And then click &#8216;View as plain text&#8217; to get the log file.</p>
<img alt="_images/job_log.png" class="align-center" src="_images/job_log.png" />
</div>
<div class="section" id="use-api-access-token">
<h2>Use Api Access Token<a class="headerlink" href="#use-api-access-token" title="Permalink to this headline">¶</a></h2>
<p>Api access token acts like ordinary OAuth token, so that you don&#8217;t need to bear the password and username with you  all the time. You can understand it as a counterpart of <a class="reference external" href="https://github.com/settings/tokens">Personal Access Tokens</a> of Github. On Insight.io, api access token is not only enabled for username/password authentication, but also for all other supported third party OAuth services enabled. This documentation shows you have to leverage api access token to interact with Insight.io with more flexibility.</p>
<p>An user could create as many api access token as he/she wants, but be extremely aware that whenever an token is created, it works forever until you delete/revoke it explicitly. So we highly recommend to always actively manage your api access token whenever necessary.</p>
<div class="section" id="token-creation">
<h3>Token Creation<a class="headerlink" href="#token-creation" title="Permalink to this headline">¶</a></h3>
<p>There are 2 ways to create an api access token, choose the one fits your use case best. In the meantime, we are building an UI to
manage api access tokens on top of these APIs.</p>
<div class="section" id="creation-after-authentication">
<h4>Creation after Authentication<a class="headerlink" href="#creation-after-authentication" title="Permalink to this headline">¶</a></h4>
<p>If you have already logged into Insight.io already, we can recognize you from your cookie. <cite>GET</cite> <cite>api/createApiToken</cite> will
generate a new token and return it to you.</p>
<p><code class="docutils literal"><span class="pre">GET</span> <span class="pre">/api/createApiToken</span></code></p>
<p><strong>Usage</strong></p>
<p>Access <code class="docutils literal"><span class="pre">$Hostname/api/createApiToken</span></code> in your browser and you should be able to generate a new api token.</p>
<img alt="images/create_api_token.png" class="align-center" src="images/create_api_token.png" />
<p>You can copy this token for later usage. If you want to find all previous created tokens, please refer to <strong>List All Tokens</strong> section below.</p>
</div>
<div class="section" id="creation-before-authentication">
<h4>Creation before Authentication<a class="headerlink" href="#creation-before-authentication" title="Permalink to this headline">¶</a></h4>
<p>You can also create an api access token without manually login.
This is mostly useful for interact with Insight.io programmatically.
Depends on how do you authenticate with Insight.io, the usage also varies.</p>
<div class="section" id="username-password">
<h5>1) Username/Password<a class="headerlink" href="#username-password" title="Permalink to this headline">¶</a></h5>
<p>If you have normal username/password account, simply <cite>POST</cite> your username and password to <cite>/api/authenticate/userpass</cite>
to authenticate your account and this will generate a new access token to you.</p>
<p><code class="docutils literal"><span class="pre">POST</span>&#160; <span class="pre">/api/authenticate/userpass</span></code></p>
<p><strong>Usage</strong></p>
<p><code class="docutils literal"><span class="pre">curl</span> <span class="pre">-i</span> <span class="pre">--data</span> <span class="pre">&quot;username=&lt;your</span> <span class="pre">username&gt;&amp;password=&lt;your</span> <span class="pre">password&gt;&quot;</span> <span class="pre">&lt;host&gt;/api/authenticate/userpass</span></code></p>
<p><strong>Response</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="p">{</span>
  <span class="s2">&quot;token&quot;</span><span class="p">:</span><span class="s2">&quot;961bb2a95e2184a97729398f39c2090b404c07d98cfda7fee6f7d1349d7c6b3577321b49ae920bb1cb4fb30862eb2d7583766a01df6680ffff0094cade160dfa04bce5e0d3fa7e2b43bd5371d1a0ab3b79bba592dbfc5f51dc75871ed4212d2549eac819a51beeaf588fb5e5d00d6241182264240f9c370e960f954a014889c0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;expiresOn&quot;</span><span class="p">:</span><span class="s2">&quot;292278994-08-17T07:12:55.807Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ldap">
<h5>2) LDAP<a class="headerlink" href="#ldap" title="Permalink to this headline">¶</a></h5>
<p>Similar to use username and password, <cite>POST</cite> your LDAP username and password to <cite>/api/authenticate/ldap</cite> instead, without
the need to register on Insight.io before.</p>
<p><code class="docutils literal"><span class="pre">POST</span> <span class="pre">/api/authenticate/ldap</span></code></p>
<p><strong>Usage</strong></p>
<p><code class="docutils literal"><span class="pre">curl</span> <span class="pre">-i</span> <span class="pre">--data</span> <span class="pre">&quot;username=&lt;your</span> <span class="pre">ldap</span> <span class="pre">username&gt;&amp;password=&lt;your</span> <span class="pre">password&gt;&quot;</span> <span class="pre">&lt;host&gt;/api/authenticate/ldap</span></code></p>
</div>
<div class="section" id="oauth">
<h5>3) OAuth<a class="headerlink" href="#oauth" title="Permalink to this headline">¶</a></h5>
<p>To create api access token with a third party OAuth service, <cite>POST</cite> your OAuth information to <cite>/api/authenticate/&lt;provider&gt;</cite> with the following <strong>json</strong> body:</p>
<p><code class="docutils literal"><span class="pre">POST</span> <span class="pre">/api/authenticate/&lt;provider&gt;</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;your email address&gt;&quot;</span><span class="p">,</span>
  <span class="s2">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;accessToken&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;your OAuth token&gt;&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Usage</strong></p>
<p>Take Github as an example:</p>
<p><code class="docutils literal"><span class="pre">curl</span> <span class="pre">-i</span> <span class="pre">--header</span> <span class="pre">&quot;Content-Type:</span> <span class="pre">application/json&quot;</span> <span class="pre">--data</span> <span class="pre">&quot;{'email':'&lt;your</span> <span class="pre">email&gt;',</span> <span class="pre">'info':</span> <span class="pre">{</span> <span class="pre">'accessToken':</span> <span class="pre">'&lt;your</span> <span class="pre">OAuth</span> <span class="pre">token&gt;'</span> <span class="pre">}}&quot;</span> <span class="pre">&lt;host&gt;/api/authenticate/github</span></code></p>
<p><strong>Response</strong></p>
<p>You will get response as below if authenticate successfully</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="p">{</span>
  <span class="s2">&quot;token&quot;</span><span class="p">:</span><span class="s2">&quot;961bb2a95e2184a97729398f39c2090b404c07d98cfda7fee6f7d1349d7c6b3577321b49ae920bb1cb4fb30862eb2d7583766a01df6680ffff0094cade160dfa04bce5e0d3fa7e2b43bd5371d1a0ab3b79bba592dbfc5f51dc75871ed4212d2549eac819a51beeaf588fb5e5d00d6241182264240f9c370e960f954a014889c0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;expiresOn&quot;</span><span class="p">:</span><span class="s2">&quot;292278994-08-17T07:12:55.807Z&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="token-usage">
<h3>Token Usage<a class="headerlink" href="#token-usage" title="Permalink to this headline">¶</a></h3>
<p>Whenever your have a token, you can talk to Insight.io via REST api without explicit authentication process. Attach the
token in <cite>X-Auth-Token</cite> HTTP header and you should be able to pass the authentication and get your desired response.</p>
<p><strong>Usage</strong></p>
<p><code class="docutils literal"><span class="pre">curl</span> <span class="pre">-v</span> <span class="pre">--header</span> <span class="pre">&quot;X-Auth-Token:&lt;your</span> <span class="pre">api</span> <span class="pre">access</span> <span class="pre">token&gt;&quot;</span> <span class="pre">&lt;host&gt;/api/getUserRecentFiles</span></code></p>
<p><strong>Response</strong></p>
<p>If you provide the correct token, you should get the desired response:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;github.com/aws/aws-sdk-java&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;aws-sdk-java&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timeStamp&quot;</span><span class="p">:</span><span class="mi">1496358397966</span><span class="p">,</span>
    <span class="s2">&quot;revision&quot;</span><span class="p">:</span><span class="s2">&quot;1.11.105&quot;</span><span class="p">,</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;aws-java-sdk-cloudhsm/src/test/java/com/amazonaws/services/cloudhsm/smoketests/RunCucumberTest.java&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;github.com/aws/aws-sdk-java&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;aws-sdk-java&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timeStamp&quot;</span><span class="p">:</span><span class="mi">1496358392087</span><span class="p">,</span>
    <span class="s2">&quot;revision&quot;</span><span class="p">:</span><span class="s2">&quot;1.11.105&quot;</span><span class="p">,</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span><span class="s2">&quot;aws-java-sdk-core/src/main/java/com/amazonaws/AmazonWebServiceRequest.java&quot;</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Otherwise, you will get error.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">401</span> <span class="n">Unauthorized</span>
<span class="p">{</span>
  <span class="s2">&quot;error&quot;</span><span class="p">:</span><span class="s2">&quot;Credentials required&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="token-deletion">
<h3>Token Deletion<a class="headerlink" href="#token-deletion" title="Permalink to this headline">¶</a></h3>
<p>To delete or revoke an api access token, <cite>GET</cite> <cite>/api/revokeApiToken</cite> with the target token attached in the <cite>X-Auth-Token</cite>.</p>
<p><code class="docutils literal"><span class="pre">GET</span> <span class="pre">/api/revokeApiToken</span></code></p>
<p><strong>Usage</strong></p>
<p><code class="docutils literal"><span class="pre">curl</span> <span class="pre">-v</span> <span class="pre">--header</span> <span class="pre">&quot;X-Auth-Token:&lt;your</span> <span class="pre">api</span> <span class="pre">access</span> <span class="pre">token&gt;&quot;</span> <span class="pre">&lt;host&gt;/api/revokeApiToken</span></code></p>
<p><strong>Response</strong></p>
<p>You will always get an <cite>HTTP/1.1 200 OK</cite> no matter whether your token is valid or not.</p>
</div>
<div class="section" id="list-all-tokens">
<h3>List All Tokens<a class="headerlink" href="#list-all-tokens" title="Permalink to this headline">¶</a></h3>
<p>To view all existing api access token in your account, <cite>GET</cite> <cite>/api/getApiTokens</cite> with any valid access token attached in the <cite>X-Auth-Token</cite>, just like calling any other REST api, which requires authentication.</p>
<p>In the response, <cite>created</cite> is the timestamp when the token was first created. <cite>lastUsed</cite> is the timestamp when the token was used
most recently.</p>
<p><strong>Usage</strong>
<code class="docutils literal"><span class="pre">curl</span> <span class="pre">-v</span> <span class="pre">--header</span> <span class="pre">&quot;X-Auth-Token:&lt;your</span> <span class="pre">api</span> <span class="pre">token&gt;&quot;</span> <span class="pre">&lt;host&gt;/api/getApiTokens</span></code></p>
<p><strong>Response</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;uid&quot;</span><span class="p">:</span><span class="s2">&quot;ldap@user.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apiToken&quot;</span><span class="p">:</span><span class="s2">&quot;95e1110da97bf616d2e6838677f0275d73c5bd9e7b746c067599f9b7def02673f09b865929255291d221943f59e2f8060624480fc3d9322ed753604a89dc501060cfd01327fa65ecf65b6c540c236a836afb1e5f3234b84d9a0c23703752bb9ba53133431e300a5ad647767d25194172c824bb2308861562f6cb704f89f5f89f&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created&quot;</span><span class="p">:</span><span class="mi">1496357580959</span><span class="p">,</span>
    <span class="s2">&quot;lastUsed&quot;</span><span class="p">:</span><span class="mi">1496357580959</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;uid&quot;</span><span class="p">:</span><span class="s2">&quot;ldap@user.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apiToken&quot;</span><span class="p">:</span><span class="s2">&quot;c9d1a9dd3ec6fa0f41543071f1c98cc6b66a7350e0ec481e45b4ac25ce962f646adfe474854ccb7b574c2ea2976670c4973c9f7b71bfedc21d4e69d4896640cac0e3a54f26fd508aadba093d192ebbb03f1e977ef03698bccb036128e8cb13b443db1709da637bbcbec72c7e8f19e697f10610f5f744902c5678f5f6cf9e218c&quot;</span><span class="p">,</span>
    <span class="s2">&quot;created&quot;</span><span class="p">:</span><span class="mi">1496358254649</span><span class="p">,</span>
    <span class="s2">&quot;lastUsed&quot;</span><span class="p">:</span><span class="mi">1496358254649</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="import-projects">
<h2>Import Projects<a class="headerlink" href="#import-projects" title="Permalink to this headline">¶</a></h2>
<div class="section" id="import-project-via-git-urls">
<h3>Import Project via Git Urls<a class="headerlink" href="#import-project-via-git-urls" title="Permalink to this headline">¶</a></h3>
<p>To import a batch of project at a time, go to your <cite>Admin Console</cite> and click the <cite>Import New Repo</cite> button
on the top right.</p>
<p>In the popped out modal, you can put multiple git urls into the input box, one url each line.</p>
<img alt="_images/import_projects.png" class="align-center" src="_images/import_projects.png" />
<p>Notice that there are 2 switchers behind the inputbox, which gives you the options to apply settings to all
the imported projects.</p>
<ul class="simple">
<li><strong>Set as Private Repository</strong>: By default, repository on Insight.io are public to all users. However,</li>
</ul>
<p>with this option opted in, your repository will only be accessible to a limited group of people.</p>
<ul class="simple">
<li><strong>Enable Manual Update</strong>: By default, Insight.io periodically pull updates from remote for all the projects, with this</li>
</ul>
<p>setting enabled, your repository won&#8217;t be updated automatically. See details in the next section.</p>
</div>
<div class="section" id="configure-manual-update">
<h3>Configure Manual Update<a class="headerlink" href="#configure-manual-update" title="Permalink to this headline">¶</a></h3>
<p>By default, Insight.io periodically pull updates of all projects from remote. We provide 2 levels of configurations
to disable auto update in <strong>System</strong> and <strong>Project</strong> levels.</p>
<div class="section" id="system-level-manual-update">
<h4>System Level Manual Update<a class="headerlink" href="#system-level-manual-update" title="Permalink to this headline">¶</a></h4>
<p>To enable repository manual update for the entire system, add the following configuration to <code class="docutils literal"><span class="pre">lambdalan-enterprise.conf</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">projectservice</span><span class="p">:</span> <span class="p">{</span>
  <span class="n">enableManualUpdate</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You need to restart the stack to apply this change. This configuration is honored with higer priority than project level
manual update, i.e., when system level manual update is enabled, even disable the manual update
for a single repository won&#8217;t work.</p>
</div>
<div class="section" id="project-level-manual-update">
<h4>Project Level Manual Update<a class="headerlink" href="#project-level-manual-update" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier in this doc, you can opt in manual repository update when your first import the project.
If you did not do that, you can also change the setting in the project configuration modal page.</p>
<img alt="_images/manual_update_project.png" class="align-center" src="_images/manual_update_project.png" />
<p>By toggling the switcher on the top and hit <cite>Update</cite> button on the bottom, you can flip the configurations of manual update
for this particular repository.</p>
</div>
</div>
<div class="section" id="trigger-manual-update">
<h3>Trigger Manual Update<a class="headerlink" href="#trigger-manual-update" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s assume you have already, either enabled the manual update for the entire system, or for a specific repository. Then
to trigger an update for a given repository, <cite>GET</cite> <cite>/api/updateProject/&lt;projectId&gt;</cite> will trigger an update for <cite>projectId</cite> repository.</p>
<p><code class="docutils literal"><span class="pre">GET</span> <span class="pre">/api/updateProject/&lt;projectId&gt;</span></code></p>
<p>Be aware that you have to authenticate before you can successfully call this API, so an API access token is required in the
<cite>X-Auth-Token</cite> header of your request.</p>
<p><strong>Usage</strong></p>
<p><code class="docutils literal"><span class="pre">curl</span> <span class="pre">-i</span> <span class="pre">--header</span> <span class="pre">&quot;X-Auth-Token:&lt;your</span> <span class="pre">access</span> <span class="pre">token&gt;&quot;</span> <span class="pre">&lt;host&gt;/api/updateProject/github.com/apache/hadoop</span></code></p>
</div>
<div class="section" id="switch-a-repo-from-public-to-private">
<h3>Switch a Repo from Public to Private<a class="headerlink" href="#switch-a-repo-from-public-to-private" title="Permalink to this headline">¶</a></h3>
<p>If you want to switch an already imported public repo to private, you can do so by calling the following API:</p>
<p><code class="docutils literal"><span class="pre">POST</span> <span class="pre">/api/switchRepoToPrivate/&lt;projectId&gt;</span></code></p>
<p>Note that this API requires admin priviledge to call.</p>
<p>After a repo is switched to private, only admin has access to it by default, you may need to push access setting for the private repo to control how it can be accessed by other users.</p>
</div>
<div class="section" id="push-user-access-throught-api">
<h3>Push User Access throught API<a class="headerlink" href="#push-user-access-throught-api" title="Permalink to this headline">¶</a></h3>
<p>You can update access of a user by calling the following API:</p>
<p><code class="docutils literal"><span class="pre">POST</span> <span class="pre">/api/admin/pushUserAccess</span></code></p>
<p>And the parameters required are as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;userId&quot;</span><span class="p">:</span><span class="s2">&quot;testuser&quot;</span><span class="p">,</span>  <span class="o">//</span> <span class="n">userId</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user</span>
  <span class="s2">&quot;providerId&quot;</span><span class="p">:</span><span class="s2">&quot;gitlab&quot;</span><span class="p">,</span> <span class="o">//</span> <span class="n">providerId</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user</span>
  <span class="s2">&quot;projectIds&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;github.com/apache/sqoop&quot;</span><span class="p">,</span> <span class="s2">&quot;github.com/dmlc/dmlc-core&quot;</span><span class="p">]</span> <span class="o">//</span><span class="n">projectIds</span> <span class="n">of</span> <span class="n">the</span> <span class="n">repos</span> <span class="n">the</span> <span class="n">user</span> <span class="n">can</span> <span class="n">access</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that this API requires admin priviledge to call.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="on_prem_install.html" class="btn btn-neutral" title="Insight.io Private Cloud Version Quick Install" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Lambdalab Corp..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>